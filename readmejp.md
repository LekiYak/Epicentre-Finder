# 震央位置特定用スクリプト
Python 3.9.9 で書かれた簡易的な地震学用のスクリプトです。

## 目次
1. [概要](#概要)
2. [手法](#手法)
3. [使用方法](#使用方法)
    1. [スクリプト](#script)
    2. [データ（方式）](#data)
4. [出力](#出力)
5. [構成](#構成)

## 概要

以下の情報を用いて地震の震央を特定するスクリプトです:
* ＰとＳ波の到達時間
* 地震計の位置
* 地震波の速度

各地震計が測定したＰとＳ波（以後は地震波）の到達時間の差を基に各地震計から震央までの距離を地震計を中心とした円として表し、円が交わる点の中から最も集結した点の平均の位置を震央として背景地図に表示します。

## 手法

青い点が地震計を表し、地震計から震央までの距離を表している円の交点がオレンジの点として表されています。円は２種の地震波の到達時間の差を基に描かれます。全ての点の平均の位置から最もずれてる点を外れ値として削り、２枚目の画像のように残りの点がある程度集結したら残りの点の平均位置を震央として背景地図の上に描かれます。（４枚目の画像）

![Initial plot](https://i.imgur.com/u6Gj408.png)
![Trimming outliers](https://i.imgur.com/HCF2qjm.png)
![Added basemap](https://i.imgur.com/9P2VTST.png)
![Final result](https://i.imgur.com/JL3vCrU.png)

## 使用方法

### スクリプト <a name="script"></a>

必要なモジュール・ライブラリをインストールし、
```
pip install -r requirements.txt
```

**src** ディレクトリの中にある **epicentre_finder.py** を実行します。

```
python epicentre_finder.py *データファイルのパス(.csv)*
```

## データ（方式） <a name="data"></a>

以下の情報が入ってる .csv ファイルが必要です:

Station | TS | TP | LAT | LONG | VS | VP
---|---|---|---|---|---|---
地震計の仮名 | S波の到達時間（秒） | P波の到達時間（秒） | 地震計の緯度 | 地震計の経度 | S波速度 (メートル/秒) | P波速度 (メートル/秒)

地震波の速度 (VS, VP) は一つの行のみに書かれていても大丈夫です。PとS波の到達時間は全て同じ時間と比較するよう入力してください（例：現地時間深夜00:00から経過した時間）。PとS波を測定データから識別する機能はついていないため、到達時間のデータは自身で行ってください。

**例**

Station | TS | TP | LAT | LONG | VS | VP
---|---|---|---|---|---|---
渋谷駅 | 12.4 | 7.82 | 35.65778063258471 | 139.702152777513 | 2300 | 4680
船橋市総合体育館 | 8.72 | 4.58 | 35.731336755458166 | 140.05167737086 | |
川越城 | 21.3 | 14.5 | 35.92436206044744 | 139.49159735432903 | |

### 出力

背景地図の上に震央の位置、地震計の位置と仮名が描かれた pyplot グラフを自動的に表示します。同時に **src** ディレクトリに `epicentre.png` として保存されます。ターミナルには震央の経緯度が表示されます。

_出力の一例_


```
The epicentre is located at:
LAT: 35.395303206618905
LONG: 139.46674702654076
35.395303206618905 , 139.46674702654076
```

## 構成
```
|-- readme.md
|-- readmejp.md
|-- requirements.txt
|-- src
    |-- epicentre_finder.py 
    |-- latlong_to_utmepsg.py
```
